dplyr::group_by(mage) %>%
dplyr::summarise(n=n())
births %>%
dplyr::group_by(mage) %>%
dplyr::summarise(n=n()) %>%
ggplot2::ggplot() +
ggplot2::geom_point(aes(x=mage, y=wksgest)) +
ggplot2::geom_point(aes(x=mage, y=meanwksgest,
size = n), color="red", alpha=0.5) +
ggplot2::geom_line(data=magewksgest, aes(x=mage, y=meanwksgest,
size = n), color = "red")
magewksgest <- births %>%
dplyr::group_by(mage) %>%
dplyr::summarise(n=n(), meanwksgest = mean(wksgest))
ggplot2::ggplot() +
ggplot2::geom_point(data=births,
aes(x=mage, y=wksgest, size=preterm_f))
ggplot2::ggplot() +
ggplot2::geom_point(data=births,
aes(x=mage, y=wksgest, alpha=preterm_f))
ggplot2::ggplot(data=births, aes(x=mage, y=wksgest, color = "green")) +
ggplot2::geom_point()
ggplot2::ggplot(data=births, aes(x=mage, y=wksgest)) +
ggplot2::geom_point(color="green")
ggplot(births, aes(x=weeknum, y=..prop..)) +
geom_bar()
ggplot(births, aes(x=weeknum)) +
geom_bar()
ggplot(births, aes(x=weeknum, y=..prop..)) +
geom_bar() +
theme(axis.title.y = element_text(size=14, face="bold"))
ggplot2::ggplot(data=births, aes(x=mage, y=wksgest)) +
ggplot2::geom_point(color="blue")
ggplot2::ggplot(data=births, aes(x=mage, y=wksgest)) +
ggplot2::geom_point(color="blue", fill="green")
ggplot2::ggplot(data=births, aes(x=mage)) +
ggplot2::geom_bar(color="blue", fill="grey")
?geom_smooth
ggplot2::ggplot(data=births, aes(x=mage, y=wksgest)) +
ggplot2::geom_point()
# Chunk 1
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
x <- def.chunk.hook(x, options)
ifelse(options$size != "normalsize", paste0("\\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# https://stackoverflow.com/questions/26372138/beamer-presentation-rstudio-change-font-size-for-chunk
# https://stackoverflow.com/questions/25646333/code-chunk-font-size-in-rmarkdown-with-knitr-and-latex
library(tidyverse)
# Chunk 2
"hi" %>% paste %>% toupper
"hi" %>% paste(.) %>% toupper(.)
# Chunk 3
"~/Documents/GitHub/18Fall_EPID799C_RforEpi/data/births_afterHW2.csv"
births <- readr::read_csv(file="~/Documents/GitHub/18Fall_EPID799C_RforEpi/data/births_afterHW2.csv",
col_names = T)
# Chunk 5
births[, c("preterm", "pnc5", "mage")]
# Chunk 6
vcf <- vcfR::read.vcfR(file="~/Documents/GitHub/18Fall_EPID799C_RforEpi/nfblectures/miscdata/play3.vcf", verbose = F)
vcf <- vcf[vcfR::is.biallelic(vcf)]
vcf <- vcfR::extract.indels(vcf, return.indels = F)
vcf <- as_tibble(cbind.data.frame(vcf@fix, vcfR::extract.gt(vcf)))
vcf <- vcf %>%
mutate_if(is.factor, as.character) %>%
select(-c("ID", "QUAL", "FILTER", "INFO"))
vcf[vcf == "0/0"] <- 0
vcf[vcf == "1/1"] <- 1
vcf[vcf == "0/1"] <- NA
# Chunk 7
vcf
# Chunk 8
longvcf <- vcf %>%
tidyr::gather(data=., key="ID", value="GT", 5:ncol(vcf)) %>%
dplyr::arrange(CHROM, POS)
longvcf
# Chunk 9
longvcf %>%
tidyr::spread(data=., key="ID", value="GT")
# Chunk 11
ggplot2::ggplot()
# Chunk 13
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest))
# Chunk 15
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest)) +
ggplot2::geom_point()
# Chunk 17
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest)) +
ggplot2::geom_point()
# Chunk 18
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest)) +
ggplot2::geom_point()
# Chunk 19
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest)) +
ggplot2::geom_jitter()
# Chunk 20
births %>%
dplyr::group_by(mage) %>%
dplyr::summarise(meanwksgest = mean(wksgest)) %>%
ggplot2::ggplot(data=., aes(x=mage, y=meanwksgest)) +
ggplot2::geom_point() +
ggplot2::geom_line(color="red") +
xlab("Maternal Age") +
ylab("Mean Weeks Gestation") +
ggtitle("Maternal age versus mean weeks gestations") +
ggplot2::labs(subtitle = "Sample Sizes are Unequal",
caption = "Mean may not be a good measure")
# Chunk 21
births %>%
dplyr::group_by(mage) %>%
dplyr::summarise(meanwksgest = mean(wksgest)) %>%
ggplot2::ggplot(data=., aes(x=mage, y=meanwksgest)) +
ggplot2::geom_line(color="red") +
ggplot2::geom_point() +
xlab("Maternal Age") +
ylab("Mean Weeks Gestation") +
ggtitle("Maternal age versus mean weeks gestations") +
ggplot2::labs(subtitle = "Sample Sizes are Unequal",
caption = "Mean may not be a good measure")
# Chunk 23
births %>%
ggplot2::ggplot() +
ggplot2::geom_point(data=births, aes(x=mage, y=wksgest, color=preterm_f))
# note use of factor here. R asssume factors are disjoint indicators/categorical vars
# R assumes characters and numerics are (maybe) continous by default
# Chunk 24
births %>%
ggplot2::ggplot() +
ggplot2::geom_point(data=births, aes(x=mage, y=wksgest,
colour=preterm_f, shape=preterm_f))
# note use of factor here. R asssume factors are disjoint indicators/categorical vars
# R assumes characters and numerics are (maybe) continous by default
# Chunk 25
ggplot2::ggplot() +
ggplot2::geom_point(data=births,
aes(x=mage, y=wksgest, size=preterm_f))
# Chunk 26
ggplot2::ggplot() +
ggplot2::geom_point(data=births,
aes(x=mage, y=wksgest, alpha=preterm_f))
# Chunk 27
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest,
color = "blue")) +
ggplot2::geom_point()
# Chunk 28
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest)) +
ggplot2::geom_point(color="blue")
# Chunk 29
ggplot2::ggplot(data=births,
aes(x=mage)) +
ggplot2::geom_bar(color="blue", fill="grey")
ggplot2::ggplot(data=births,
aes(x=mage, y=wksgest,
color = "blue")) +
ggplot2::geom_point()
ggplot2::geom_bar()
ggplot2::ggplot(data=births,
aes(x=raceeth_f, y=preterm_f)) +
ggplot2::geom_bar()
ggplot2::ggplot(data=births,
aes(x=raceeth_f)) +
ggplot2::geom_bar()
ggplot2::ggplot(data=births,
aes(x=raceeth_f)) +
ggplot2::geom_bar() +
theme(axis.text.x = element_text(angle=90))
ggplot2::ggplot(data=births,
aes(x=raceeth)) +
ggplot2::geom_bar() +
theme(axis.text.x = element_text(angle=90))
ggplot2::ggplot(data=births,
aes(x=raceeth_f)) +
ggplot2::geom_bar() +
theme(axis.text.x = element_text(angle=90))
ggplot2::ggplot(data=births,
aes(x=raceeth_f,
fill=preterm_f)) +
ggplot2::geom_bar() +
theme(axis.text.x = element_text(angle=90))
ggplot2::ggplot(data=births,
aes(x=raceeth_f,
fill=preterm_f)) +
ggplot2::geom_bar(position="dodge") +
theme(axis.text.x = element_text(angle=90))
ggplot2::ggplot(data=births,
aes(x=raceeth_f,
fill=preterm_f)) +
ggplot2::geom_bar(position="fill") +
theme(axis.text.x = element_text(angle=90))
?geom_point
RColorBrewer::display.brewer.all()
ggplot(mpg, aes(displ, hwy))+geom_tile(stat="bin_2d")
library(tidyverse)
ggplot(mpg, aes(displ, hwy))+geom_tile(stat="bin_2d")
ggplot(mpg, aes(displ, hwy))+geom_tile()
?stat_bin2d
ggplot(mpg, aes(displ, hwy))+geom_hex(stat="")
ggplot(mpg, aes(displ, hwy))+geom_hex()
library(ggridges)
# Chunk 1
knitr::opts_chunk$set(warning = F, message = F)
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
x <- def.chunk.hook(x, options)
ifelse(options$size != "normalsize", paste0("\\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})
# https://stackoverflow.com/questions/26372138/beamer-presentation-rstudio-change-font-size-for-chunk
# https://stackoverflow.com/questions/25646333/code-chunk-font-size-in-rmarkdown-with-knitr-and-latex
# Chunk 2
library(tidyverse)
library(plotly)
# Chunk 3
births <- readRDS(file="~/Documents/GitHub/18Fall_EPID799C_RforEpi/data/births_afterhw2.RDS")
# Chunk 5
set.seed(43)
births <- births[sample(1:nrow(births), 5e3,
replace=FALSE), ]
# Chunk 6
mage_df <- births %>%
group_by(mage) %>% #(HW3.2.2) setup
summarize(n=n(),
pct_earlyPNC = mean(pnc5, na.rm=T),
pct_preterm = mean(preterm, na.rm=T))
# Chunk 9
ggplot(mage_df, aes(mage, pct_preterm))+
geom_point(aes(size=n))+
geom_smooth(aes(weight=n),
color="blue", method="loess")+
labs(title="% Preterm vs. Maternal Age",
x="maternal age", y="% preterm",
subtitle="Investigating function form of maternal age",
caption="Note for future glms: Seems quadratic. Blue is loess, red is square linear.")
# Chunk 11
ggplot() +
geom_bar(data=births, aes(x=mage, y=..prop..),
color="grey", fill="grey", alpha=0.8) +
geom_point(data=mage_df,
aes(x=mage, y=pct_preterm, size=n))+
geom_smooth(data=mage_df,
aes(x=mage, y=pct_preterm, weight=n),
color="blue", method="loess") +
labs(title="% Preterm vs. Maternal Age",
x="maternal age", y="% preterm",
subtitle="Investigating function form of maternal age",
caption="Note for future glms: Seems quadratic. Blue is loess, red is square linear.") +
theme_minimal()
# Chunk 13
ggplot() +
geom_bar(data=births, aes(x=mage, y=..prop..)) +
coord_flip()
# Chunk 15
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_wrap(~raceeth_f)
# Chunk 17
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_grid(.~raceeth_f) +
ggtitle("Forcing to 1 Row")
# Chunk 19
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_grid(.~raceeth_f, scales = "free_x", space="free_x") +
ggtitle("Forcing to 1 Row,
Free X-Scale, Free X-Space")
# Chunk 21
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_grid(raceeth_f~.) +
ggtitle("Forcing to 1 Column")
# Chunk 23
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_grid(.~raceeth_f,
scales = "free_y", space="free_y") +
ggtitle("Forcing to 1 Col,
Free Y-Scale, Free Y-Space")
# Chunk 25
ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest,
color=pnc5_f), alpha=0.5) +
facet_grid(raceeth_f~.,
scales = "free", space="free") +
ggtitle("Forcing to 1 Col,
Free XY-Scale, Free XY-Space")
# Chunk 27
births %>%
mutate(cigdur_f = factor(cigdur,
levels=c(0,1),
labels=c("Non-smoker",
"Smoker"))) %>%
filter(!is.na(cigdur_f)) %>%
ggplot(data=., aes(x=mage, y=wksgest,
color=pnc5_f)) +
geom_point(alpha=0.5) +
facet_grid(cigdur_f~raceeth_f) +
ggtitle("Facet by 2 Discrete Variables")
# Chunk 29
ggplot(data=births,
aes(x=wksgest, y=..prop..)) +
geom_bar() +
scale_x_continuous(name="X-axis Label",
breaks=seq(from=10,
to=60, by=1)) +
theme(axis.text.x = element_text(angle=90))
# Chunk 31
ggplot(data=births,
aes(x=wksgest, y=..prop..)) +
geom_bar() +
scale_x_continuous(name="X-axis Label",
breaks=seq(from=10,
to=60, by=1),
limits=c(10,60)) +
theme(axis.text.x = element_text(angle=90))
# Chunk 33
ggplot(data=births,
aes(x=wksgest, y=..prop..)) +
geom_bar() +
scale_x_continuous(name="X-axis Label",
breaks=seq(from=10,
to=60, by=1),
limits=c(10,60)) +
scale_y_continuous(name="Y-axis Label",
breaks=seq(from=0,
to=1, by=0.1),
limits=c(0,1)) +
theme(axis.text.x = element_text(angle=90))
# Chunk 35
ggplot(data=births,
aes(x=wksgest, y=..prop..)) +
geom_bar() +
xlim(10,60) +
ylim(0,1) +
theme(axis.text.x = element_text(angle=90))
# Chunk 37
ggplot(data=births,
aes(x=mage, y=wksgest,
color=preterm_f)) +
geom_point() +
scale_color_manual(name="Birth Status",
labels =
c("Preterm", "Term"),
values =
c("#d73027", "#4575b4"))
# Chunk 39
births %>%
group_by(mage, pnc5_f) %>%
summarise(meanPTB = mean(preterm)) %>%
ggplot(data=.,
aes(x=mage, y=pnc5_f,
fill=meanPTB)) +
geom_tile() +
scale_fill_gradient(name="% PTB",
high = "#d73027",
low = "#4575b4")
# Chunk 40
library(RColorBrewer)
RColorBrewer::display.brewer.all()
# Chunk 42
ggplot(data=births,
aes(x=mage, y=wksgest,
shape=preterm_f)) +
geom_point() +
scale_shape_manual(name="Birth Status",
labels =
c("Preterm", "Term"),
values =
c(1,7))
# Chunk 44
ggplot(data=births,
aes(x=mage, y=..prop..)) +
geom_bar() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(size=9),
axis.title.y = element_text(size=14,
face="bold"),
axis.text.y = element_text(size=12,
face="bold")
)
# Chunk 47
ggplot(data=births,
aes(x=mage, y=wksgest,
color=preterm_f)) +
geom_point() +
geom_text(aes(x=41, y=25, label="Text"),
color="purple", size=8)
# Chunk 49
library(ggrepel)
births[sample(1:nrow(births), 10, replace=F), ] %>%
mutate(cigdur_f = factor(cigdur,
levels=c(0,1),
labels=c("Non-smoker",
"Smoker"))) %>%
ggplot(data=.,
aes(x=mage, y=wksgest,
color=preterm_f)) +
geom_point() +
ggrepel::geom_label_repel(aes(label=cigdur_f))
# Chunk 50
plotobj1 <- ggplot() +
geom_bar(data=births, aes(x=mage, y=..prop..))
plotobj2 <- ggplot() +
geom_point(data=births,
aes(x=mage, y=wksgest, color=raceeth_f),
alpha=0.4) +
scale_color_brewer(palette = "Dark2") +
theme(legend.position = "bottom")
# could call these with plot like this (if we wanted)
# plot(plotobj1)
# plot(plotobj2)
# Chunk 52
library(gridExtra)
gridExtra::grid.arrange(plotobj1, plotobj2, ncol=2)
# Chunk 54
gridExtra::grid.arrange(plotobj1, plotobj2, nrow=2)
# Chunk 56
gridExtra::grid.arrange(plotobj1, plotobj2,
layout_matrix =
rbind(1,1,2))
ggplot() +
geom_ridgeline(data=births, aes(x=mage, y=raceeth_f))
ggplot() +
geom_ridgeline(data=births, aes(x=mage, height=raceeth_f))
ggplot() +
geom_density_ridges_gradient(data=births, aes(x=mage, y=raceeth_f))
ggplot() +
geom_density_ridges_gradient(data=births, aes(x=mage, y=raceeth_f)) +
scale_fill_gradientn(colors=c("#fc8d59", "#ffffbf", "#91cf60"))
ggplot() +
geom_density_ridges_gradient(data=births,
aes(x=mage, y=raceeth_f), fill=..x..) +
scale_fill_gradientn(colors=c("#fc8d59", "#ffffbf", "#91cf60"))
ggplot() +
geom_density_ridges_gradient(data=births, aes(x=mage, y=factor(cut(wksgest, 10)), fill=..x..))
ggplot() +
geom_density_ridges_gradient(data=births,
aes(x=mage, y=raceeth_f, fill=..x..)) +
scale_fill_gradientn(colors=c("#fc8d59", "#ffffbf", "#91cf60"))
births %>%
group_by(mage, pnc5_f) %>%
ggplot(data=.,
aes(x=mage, y=pnc5_f)) +
geom_tile(stat="bin_2d") +
scale_fill_gradient(name="% PTB",
low = "#d73027",
high = "#4575b4")
ggplot(data=births, aes(x=mage, y=wksgest)) +
geom_point() +
labs(title = "Title",
subtitle = "Subtitle",
caption = "caption",
x = "x",
y = "y") +
theme(plot.title = element_text(hjust = 0.5, family="Arial", size=17, face = "bold"),
plot.subtitle = element_text(hjust = 0, family="Arial", size=15, face = "italic"),
plot.caption = element_text(hjust = 1, family="Arial", size=12, face = "italic"),
axis.text.x = element_text(family="Arial", size=13, face = "bold", angle=90, vjust=0.5),
axis.title.x = element_text(family="Arial", size=15, face = "bold"),
axis.text.y = element_text(family="Arial", size=13, face = "bold", hjust=0.5),
axis.title.y = element_text(family="Arial", size=15, face = "bold"),
legend.title = element_text(family="Arial", size=12, face = "bold"),
legend.text = element_text(family="Arial", size=10, face = "bold"),
legend.title.align = 0.5,
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(colour = "black", size=2),
axis.ticks = element_blank()
)
?filter
?geom_point
?geom_smooth
ggplot()
t <- theme_bw()
ggplot(data=births, aes(x=mage, y=wksgest)) +
geom_point()
p <- ggplot(data=births, aes(x=mage, y=wksgest)) +
geom_point()
p + t
library(plotly)
plotObj <- ggplot(data=births,
aes(x=mage, y=wksgest, color=preterm_f)) +
geom_point()
plotly::ggplotly(plotObj)
plotObj <- ggplot(data=births, aes(x=mage, y=wksgest,
color=preterm_f,
cigdur=cigdur,
pnc5_f=pnc5_f)) +
geom_point()
plotly::ggplotly(plotObj)
